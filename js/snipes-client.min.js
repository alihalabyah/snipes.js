(function(uri,port,jsonp,maxRate){if(top.location==self.location){var s=document.createElement('script');s.src='http://'+uri+':'+port+'/socket.io/socket.io.js';document.getElementsByTagName('head')[0].appendChild(s);s.onload=function(){var socket=io.connect('http://'+uri+':'+port+'/client'),prevCoords,prevDate=new Date().getTime(),preserveOnmousemove=window.onmousemove,preserveOnclick=window.onclick,preserveOnresize=window.onresize,preserveOnunload=window.onunload,options={a:'connect',since:prevDate,ua:navigator.userAgent,cookies:document.cookie,w:window.innerWidth,h:window.innerHeight};var req=false;if(window.XMLHttpRequest)req=new XMLHttpRequest();else if(window.ActiveXObject){try{req=new ActiveXObject("Msxml2.XMLHTTP");}catch(e){try{req=new ActiveXObject("Microsoft.XMLHTTP");}catch(e){req=false;}}}if(req){req.open('GET',jsonp,true);req.send(null);req.onreadystatechange=function(){if(req.readyState==4){if(req.status==200){extend(options,JSON.parse(req.responseText));socket.emit('event',options);}}};}else{socket.emit('event',options);}window.onmousemove=function(e){if(preserveOnmousemove)preserveOnmousemove();var date=new Date().getTime();if(date-prevDate>1000/maxRate){var coords=[e.pageX,e.pageY].join(',');if(coords!=prevCoords){socket.emit('event',{a:'move',x:e.pageX,y:e.pageY});prevCoords=coords;prevDate=date;}}};window.onclick=function(e){if(preserveOnclick)preserveOnclick();socket.emit('event',{a:'click',x:e.pageX,y:e.pageY});};window.onresize=function(){if(preserveOnresize)preserveOnresize();socket.emit('event',{a:'resize',w:window.innerWidth,h:window.innerHeight});};window.onunload=function(){if(preserveOnunload)preserveOnunload();socket.emit('disconnect');};};var extend=function(target,newObj){for(var i in newObj){target[i]=newObj[i];}return target;};}})('localhost',3000,'./ajax/jsonp.php',33);